<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>☰ Article Explorer ☰</title>
<style>
  body {
    font-family: monospace;
    background: #0e0e10;
    color: #f4f4f4;
    padding: 20px;
  }
  h2 { color: #ff5555; }
  label { display: block; margin-top: 10px; }
  input, select {
    width: 100%;
    padding: 6px;
    background: #1e1e22;
    color: #fff;
    border: 1px solid #333;
    border-radius: 5px;
  }
  .row { display: flex; gap: 10px; flex-wrap: wrap; }
  .row > div { flex: 1; min-width: 200px; }
  #layout { display: flex; gap: 20px; flex-wrap: wrap; }
  #articleList { flex: 1 1 100%; }
  .articleCard {
    background: #1e1e22;
    border: 1px solid #333;
    border-radius: 5px;
    padding: 10px;
    margin-top: 10px;
    cursor: pointer;
  }
  .articleCard:hover { border-color: #ff5555; }

  #popupOverlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 100;
  }
  #popup {
    background: #1e1e22;
    border: 1px solid #333;
    border-radius: 8px;
    padding: 20px;
    width: 95%;
    height: 95%;
    overflow-y: auto;
    position: relative;
  }
  #popup h2 { color: #ff5555; margin-top: 0; }
  #popupMeta { color: #aaa; margin-bottom: 15px; }
  #popupContent { white-space: pre-wrap; }
  #popupCloseBtn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: #ff5555;
    color: white;
    border: none;
    padding: 6px 12px;
    cursor: pointer;
    border-radius: 5px;
  }

  .subtitle {
    font-size: 20px;
    font-weight: bold;
    margin-top: 15px;
    margin-bottom: 10px;
  }

  footer {
    text-align: center;
    margin-top: 25px;
    color: #777;
    font-size: 0.9em;
  }
</style>
</head>
<body>
  <h2>☰ Article Explorer ☰</h2>

  <div class="row">
    <div>
      <label>Search:</label>
      <input id="searchInput" placeholder="Search articles...">
    </div>
    <div>
      <label>Filter by Category:</label>
      <select id="filterCategory">
        <option value="">All</option>
      </select>
    </div>
    <div>
      <label>Filter by Author:</label>
      <select id="filterAuthor">
        <option value="">All</option>
      </select>
    </div>
  </div>

  <div id="layout">
    <div id="articleList">
      <h3>Articles</h3>
      <div id="articles"></div>
    </div>
  </div>

  <div id="popupOverlay">
    <div id="popup">
      <button id="popupCloseBtn">Close</button>
      <h2 id="popupTitle"></h2>
      <div id="popupMeta"></div>
      <div id="popupContent"></div>
    </div>
  </div>

  <footer>Made by Orpheus1190 (Neptune6866)</footer>

<script>
(async function(){
  const list = document.getElementById('articles');
  const search = document.getElementById('searchInput');
  const catFilter = document.getElementById('filterCategory');
  const authorFilter = document.getElementById('filterAuthor');

  let articles = [];

  async function loadArticles() {
    try {
      const res = await fetch('articles/index.json');
      const files = await res.json();
      const loaded = await Promise.all(
        files.map(async f => {
          const r = await fetch('articles/' + f);
          const j = await r.json();
          j._filename = f;
          return j;
        })
      );
      articles = loaded;
      renderFilters();
      renderArticles();
    } catch (e) {
      list.innerHTML = '<p style="color:#ff5555;">Failed to load articles.</p>';
      console.error(e);
    }
  }

  function renderFilters() {
    const cats = [...new Set(articles.map(a => a.category).filter(Boolean))];
    const authorsSet = new Set();
    articles.forEach(a => {
      if(a.author) {
        a.author.split(',').map(s => s.trim()).forEach(name => authorsSet.add(name));
      }
    });
    const authors = [...authorsSet];

    catFilter.innerHTML = '<option value="">All</option>' + cats.map(c=>`<option>${c}</option>`).join('');
    authorFilter.innerHTML = '<option value="">All</option>' + authors.map(a=>`<option>${a}</option>`).join('');
  }

  function renderArticles() {
    const query = search.value.toLowerCase();
    const cat = catFilter.value;
    const author = authorFilter.value;
    list.innerHTML = '';

    articles.filter(a => 
      (!query || a.title.toLowerCase().includes(query) || a.content.toLowerCase().includes(query)) &&
      (!cat || a.category === cat) &&
      (!author || a.author.split(',').map(s => s.trim()).includes(author))
    ).forEach(a => {
      const div = document.createElement('div');
      div.className = 'articleCard';
      div.innerHTML = `<strong>${a.title}</strong><br>${a.author} | ${a.category} | ${a.date}`;
      div.onclick = () => openPopup(a);
      list.appendChild(div);
    });
  }

  const popupOverlay = document.getElementById('popupOverlay');
  const popupTitle = document.getElementById('popupTitle');
  const popupMeta = document.getElementById('popupMeta');
  const popupContent = document.getElementById('popupContent');
  const popupCloseBtn = document.getElementById('popupCloseBtn');

  function openPopup(article){
    popupTitle.textContent = article.title || '';
    popupMeta.textContent = `${article.author} | ${article.category} | ${article.date}`;
    popupContent.innerHTML = article.content || '';
    popupOverlay.style.display = 'flex';
  }

  popupCloseBtn.onclick = () => {
    popupOverlay.style.display = 'none';
  };

  search.oninput = catFilter.onchange = authorFilter.onchange = renderArticles;
  loadArticles();
})();
</script>
</body>
</html>
